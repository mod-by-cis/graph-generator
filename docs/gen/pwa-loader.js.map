{
  "version": 3,
  "sources": ["../../code/pwa/loader.ts"],
  "sourcesContent": ["/**\r\n * @file ./code/pwa/loader.ts\r\n * @author https://github.com/j-Cis\r\n * @description Rejestruje Service Worker i zarz\u0105dza aktualizacjami w TS.\r\n * Wersja ostateczna, zgodna z dzia\u0142aj\u0105c\u0105 logik\u0105 JS.\r\n */\r\n\r\n// Upewniamy si\u0119, \u017Ce przegl\u0105darka wspiera Service Workery\r\nif ('serviceWorker' in navigator) {\r\n  // Czekamy, a\u017C strona si\u0119 w pe\u0142ni za\u0142aduje\r\n  window.addEventListener('load', () => {\r\n    \r\n    // U\u017Cywamy POPRAWNEJ \u015Bcie\u017Cki do naszego wygenerowanego pliku sw.js\r\n    navigator.serviceWorker.register('/graph-generator/gen/sw.js', { scope: '/graph-generator/' })\r\n      .then(registration => {\r\n        console.log('[PWA Loader] Service Worker zosta\u0142 pomy\u015Blnie zarejestrowany. Zakres:', registration.scope);\r\n        \r\n        // Nas\u0142uchujemy na zdarzenie 'updatefound', kt\u00F3re oznacza, \u017Ce pobierana jest nowa wersja SW.\r\n        registration.addEventListener('updatefound', () => {\r\n          const newWorker = registration.installing;\r\n          \r\n          if (newWorker) {\r\n            console.log('[PWA Loader] Znaleziono now\u0105 wersj\u0119 Service Workera. Stan:', newWorker.state);\r\n\r\n            newWorker.addEventListener('statechange', () => {\r\n              // Gdy nowy SW jest zainstalowany i gotowy do przej\u0119cia kontroli...\r\n              if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {\r\n                // ...wtedy wiemy, \u017Ce aktualizacja jest dost\u0119pna.\r\n                console.log('[PWA Loader] Aktualizacja gotowa do instalacji. Wysy\u0142am zdarzenie \"swUpdate\".');\r\n                // Wysy\u0142amy niestandardowe zdarzenie, na kt\u00F3re nasza aplikacja Preact b\u0119dzie nas\u0142uchiwa\u0107.\r\n                const updateEvent = new CustomEvent('swUpdate', { detail: newWorker });\r\n                window.dispatchEvent(updateEvent);\r\n              }\r\n            });\r\n          }\r\n        });\r\n      })\r\n      .catch(error => {\r\n        console.error('[PWA Loader] B\u0142\u0105d podczas rejestracji Service Workera:', error);\r\n      });\r\n  });\r\n}\r\n"],
  "mappings": "AAQI,kBAAmB,WAErB,OAAO,iBAAiB,OAAQ,IAAM,CAGpC,UAAU,cAAc,SAAS,6BAA8B,CAAE,MAAO,mBAAoB,CAAC,EAC1F,KAAKA,GAAgB,CACpB,QAAQ,IAAI,iFAAwEA,EAAa,KAAK,EAGtGA,EAAa,iBAAiB,cAAe,IAAM,CACjD,IAAMC,EAAYD,EAAa,WAE3BC,IACF,QAAQ,IAAI,uEAA8DA,EAAU,KAAK,EAEzFA,EAAU,iBAAiB,cAAe,IAAM,CAE9C,GAAIA,EAAU,QAAU,aAAe,UAAU,cAAc,WAAY,CAEzE,QAAQ,IAAI,oFAA+E,EAE3F,IAAMC,EAAc,IAAI,YAAY,WAAY,CAAE,OAAQD,CAAU,CAAC,EACrE,OAAO,cAAcC,CAAW,CAClC,CACF,CAAC,EAEL,CAAC,CACH,CAAC,EACA,MAAMC,GAAS,CACd,QAAQ,MAAM,mEAA0DA,CAAK,CAC/E,CAAC,CACL,CAAC",
  "names": ["registration", "newWorker", "updateEvent", "error"]
}
