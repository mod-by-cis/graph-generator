{
  "version": 3,
  "sources": ["../../code/config/path.ts", "../../code/pwa/sw.ts"],
  "sourcesContent": ["export const dirWithIcons = \"ico\";\r\nexport const dirWithBuild = \"gen\";\r\n\r\nexport const allIcons = {\r\n  ico: \"${dirWithIcons}/favicon.ico\",\r\n  png:{\r\n    icon_016:{file: `${dirWithIcons}/icon-016.png`, sizePX:16  , length:    770},\r\n    icon_032:{file: `${dirWithIcons}/icon-032.png`, sizePX:32  , length:   2220},\r\n    icon_048:{file: `${dirWithIcons}/icon-048.png`, sizePX:48  , length:   4412},\r\n    icon_128:{file: `${dirWithIcons}/icon-128.png`, sizePX:128 , length:  25723},\r\n    icon_144:{file: `${dirWithIcons}/icon-144.png`, sizePX:144 , length:  31607},\r\n    icon_152:{file: `${dirWithIcons}/icon-152.png`, sizePX:152 , length:  34782},\r\n    icon_167:{file: `${dirWithIcons}/icon-167.png`, sizePX:167 , length:  41189},\r\n    icon_180:{file: `${dirWithIcons}/icon-180.png`, sizePX:180 , length:  47062},\r\n    icon_192:{file: `${dirWithIcons}/icon-192.png`, sizePX:192 , length:  53288},\r\n    icon_256:{file: `${dirWithIcons}/icon-256.png`, sizePX:256 , length:  90131},\r\n    icon_384:{file: `${dirWithIcons}/icon-384.png`, sizePX:384 , length: 195378},\r\n    icon_512:{file: `${dirWithIcons}/icon-512.png`, sizePX:512 , length: 332134},\r\n    icon_max:{file: `${dirWithIcons}/icon-max.png`, sizePX:1024, length:1198653},\r\n  //  icon_xxl:{file: `${dirWithIcons}/icon-xxl.png`, sizePX:3936, length:7586280},\r\n  //  icon_xxm:{file: `${dirWithIcons}/icon-xxm.png`, sizePX:1969, length:3471087}\r\n  }\r\n};\r\n", "/**\r\n * @file ./code/pwa/sw.ts\r\n * @author https://github.com/j-Cis\r\n * @description Service Worker w TypeScript, wiernie odtwarzaj\u0105cy logik\u0119 z sw.js.\r\n */\r\n// @ts-nocheck\r\nimport { allIcons, dirWithBuild } from \"../config/path.ts\";\r\n\r\ndeclare const self: ServiceWorkerGlobalScope;\r\n\r\n// Zmiana tej nazwy wymusi aktualizacj\u0119 u wszystkich u\u017Cytkownik\u00F3w\r\nconst CACHE_NAME = 'graph-generator-cache-v4.1'; // Nowa, czysta wersja\r\nconst publicPath = \"/graph-generator\";\r\n\r\n// --- POPRAWIONA LISTA PLIK\u00D3W ---\r\nconst CRITICAL_FILES = [\r\n  `${publicPath}/`,\r\n  `${publicPath}/index.html`,\r\n  `${publicPath}/${dirWithBuild}/manifest.webmanifest`,\r\n];\r\n\r\nconst GENERATED_FILES = [\r\n  `${publicPath}/${dirWithBuild}/pwa-loader.js`,\r\n  `${publicPath}/${dirWithBuild}/pwa-loader.js.lastBuild.txt`,\r\n  `${publicPath}/${dirWithBuild}/sw.js`,\r\n  `${publicPath}/${dirWithBuild}/sw.js.lastBuild.txt`,\r\n  `${publicPath}/${dirWithBuild}/wasm-dot.mjs`,\r\n  `${publicPath}/${dirWithBuild}/wasm-dot.mjs.lastBuild.txt`,\r\n  `${publicPath}/${dirWithBuild}/main.mjs`,\r\n  `${publicPath}/${dirWithBuild}/main.mjs.lastBuild.txt`,\r\n  `${publicPath}/${dirWithBuild}/main.css`,\r\n  `${publicPath}/${dirWithBuild}/main.css.lastBuild.txt`,\r\n];\r\n\r\nconst ICON_FILES = Object.values(allIcons.png).map(icon => `${publicPath}/${icon.file}`);\r\nconst FAVICON = `${publicPath}/${allIcons.ico}`;\r\n\r\n// --- PRZYWR\u00D3CONA ZALE\u017BNO\u015A\u0106 Z CDN ---\r\nconst CDN_DEPENDENCIES = [\r\n  'https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs/loader.js'\r\n];\r\n\r\n// \u0141\u0105czymy wszystkie listy\r\nconst FILES_TO_CACHE = [\r\n  ...CRITICAL_FILES, \r\n  ...GENERATED_FILES, \r\n  ...ICON_FILES, \r\n  FAVICON,\r\n  ...CDN_DEPENDENCIES\r\n];\r\n\r\n// 1. Instalacja Service Workera\r\nself.addEventListener('install', (event) => {\r\n  console.log(`[ServiceWorker] Instalacja nowej wersji: ${CACHE_NAME}`);\r\n  event.waitUntil(\r\n    caches.open(CACHE_NAME).then((cache) => {\r\n      console.log('[ServiceWorker] Zapisywanie plik\u00F3w w pami\u0119ci podr\u0119cznej...');\r\n      return cache.addAll(FILES_TO_CACHE);\r\n    }).catch(err => {\r\n      console.error(\"[ServiceWorker] B\u0142\u0105d podczas `addAll` w trakcie instalacji:\", err);\r\n      // Wypisz list\u0119 plik\u00F3w, aby \u0142atwiej zdebugowa\u0107, kt\u00F3ry zawi\u00F3d\u0142\r\n      console.error(\"Nie uda\u0142o si\u0119 zapisa\u0107 jednego z plik\u00F3w. Sprawd\u017A, czy \u015Bcie\u017Cki s\u0105 poprawne:\", FILES_TO_CACHE);\r\n    })\r\n  );\r\n  // Zmu\u015B nowego Service Workera do natychmiastowej aktywacji po instalacji.\r\n  self.skipWaiting();\r\n});\r\n\r\n// 2. Aktywacja Service Workera\r\nself.addEventListener('activate', (event) => {\r\n  console.log(`[ServiceWorker] Aktywacja nowej wersji: ${CACHE_NAME}`);\r\n  // Usu\u0144 wszystkie stare, nieu\u017Cywane ju\u017C wersje cache.\r\n  event.waitUntil(\r\n    caches.keys().then((keyList) => {\r\n      return Promise.all(keyList.map((key) => {\r\n        if (key !== CACHE_NAME) {\r\n          console.log('[ServiceWorker] Usuwanie starej pami\u0119ci podr\u0119cznej:', key);\r\n          return caches.delete(key);\r\n        }\r\n      }));\r\n      // Pozw\u00F3l nowemu SW przej\u0105\u0107 kontrol\u0119 nad wszystkimi otwartymi kartami.\r\n    }).then(() => self.clients.claim())\r\n  );\r\n});\r\n\r\n// 3. Przechwytywanie zapyta\u0144 sieciowych (Fetch)\r\n/*\r\nself.addEventListener('fetch', (event) => {\r\n  // Dla \u017C\u0105da\u0144 nawigacyjnych (otwieranie strony) zawsze pr\u00F3buj najpierw z sieci.\r\n  if (event.request.mode === 'navigate') {\r\n    event.respondWith(\r\n      fetch(event.request).catch(() => {\r\n        // Je\u015Bli sie\u0107 zawiedzie, zwr\u00F3\u0107 g\u0142\u00F3wny plik z cache.\r\n        return caches.match('/graph-generator/index.html');\r\n      })\r\n    );\r\n    return;\r\n  }\r\n  \r\n  // Dla wszystkich innych zasob\u00F3w (CSS, JS) u\u017Cyj strategii \"Cache First\".\r\n  event.respondWith(\r\n    caches.match(event.request).then((response) => {\r\n      return response || fetch(event.request);\r\n    })\r\n  );\r\n});\r\n\r\n\r\nself.addEventListener('fetch', (event) => {\r\n  // U\u017Cyjemy prostej i niezawodnej strategii: \"Network falling back to cache\".\r\n  event.respondWith(\r\n    fetch(event.request)\r\n      .then((response) => {\r\n        // Je\u015Bli odpowied\u017A z sieci jest poprawna, zapiszmy j\u0105 w cache na przysz\u0142o\u015B\u0107.\r\n        if (response && response.status === 200 && event.request.method === 'GET') {\r\n          const responseToCache = response.clone();\r\n          caches.open(CACHE_NAME).then((cache) => {\r\n            cache.put(event.request, responseToCache);\r\n          });\r\n        }\r\n        return response;\r\n      })\r\n      .catch(() => {\r\n        // Je\u015Bli sie\u0107 zawiedzie (jeste\u015B offline), spr\u00F3buj znale\u017A\u0107 odpowied\u017A w cache.\r\n        return caches.match(event.request);\r\n      })\r\n  );\r\n});\r\n\r\n*/\r\n\r\n//  preferowana strategia \"Network falling back to cache\"\r\nself.addEventListener('fetch', (event) => {\r\n  // U\u017Cyjemy prostej i niezawodnej strategii: \"Network falling back to cache\".\r\n  if (event.request.method !== 'GET' || event.request.url.startsWith('chrome-extension://')) {\r\n    return;\r\n  }\r\n  event.respondWith(\r\n    fetch(event.request)\r\n      .then((response) => {\r\n        if (response && response.status === 200) {\r\n          const responseToCache = response.clone();\r\n          caches.open(CACHE_NAME).then((cache) => {\r\n            cache.put(event.request, responseToCache);\r\n          });\r\n        }\r\n        return response;\r\n      })\r\n      .catch(() => {\r\n        return caches.match(event.request);\r\n      })\r\n  );\r\n});\r\n\r\n// 4. Komunikacja z aplikacj\u0105\r\nself.addEventListener('message', (event) => {\r\n  if (event.data && event.data.type === 'SKIP_WAITING') {\r\n    self.skipWaiting();\r\n  }\r\n});\r\n"],
  "mappings": "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",
  "names": ["dirWithIcons", "dirWithBuild", "allIcons", "CACHE_NAME", "publicPath", "CRITICAL_FILES", "dirWithBuild", "GENERATED_FILES", "ICON_FILES", "allIcons", "icon", "FAVICON", "CDN_DEPENDENCIES", "FILES_TO_CACHE", "event", "cache", "err", "keyList", "key", "response", "responseToCache"]
}
